# 声明小说生成系统的prompt配置文件
# 包含4个处理阶段的prompt模板

# 版权规避配置
copyright_bypass:
  enabled: true
  # 世界观改写选项
  world_options:
    - "玄幻修真世界"
    - "都市异能世界"
    - "末世求生世界"
    - "系统流穿书世界"
    - "星际修仙世界"
    - "武侠江湖世界"
    - "无限流副本世界"
    - "田园休闲世界"
    - "仙侠神话世界"
    - "奇幻魔法世界"
  
  # 各世界观风格的详细描述
  world_descriptions:
    fantasy_cultivation: "玄幻修真世界：存在炼气、金丹、元婴等境界，宗门林立，可夺天材地宝，悟大道法则，有飞天遁地之能，人物多为修士、宗门弟子、散修等"
    urban_superpower: "都市异能世界：现代都市中隐藏着觉醒异能的人群，可操控元素、读心、自愈等，异能者组成隐秘组织，与普通人世界并行，人物可为异能者、猎人、觉醒者等"
    apocalyptic_survival: "末世求生世界：丧尸 / 异兽横行，文明崩坏，人类抱团求生，可觉醒异能或依靠科技，资源匮乏，充满背叛与希望，人物多为幸存者、基地首领、异能者等"
    system_transmigration: "系统流穿书世界：主角携带系统穿入小说世界，完成任务获奖励，可改剧情、打脸反派，系统功能多样，人物为宿主、系统、原书角色等"
    interstellar_cultivation: "星际修仙世界：修真与星际科技结合，修士乘星舰穿梭星系，夺星际资源，与外星种族修仙者交锋，有星际宗门、修真家族，人物为星际修士、星舰舰长等"
    martial_arts_world: "武侠江湖世界：门派众多，武功秘籍藏于江湖，有轻功、内力，讲究侠义与恩怨，武林大会定排名，人物为侠客、掌门、魔教教主等"
    infinite_dungeon: "无限流副本世界：参与者被拉入异空间，闯不同副本（恐怖片、历史、未来等），完成任务得积分强化自身，副本危险重重，人物为参与者、副本 NPC 等"
    pastoral_leisure: "田园休闲世界：远离纷争的乡村或异界田园，可种田、养宠、炼丹，节奏舒缓，侧重生活细节与情感，人物为农家子、穿越者、隐居者等"
    xianxia_myth: "仙侠神话世界：基于神话传说，有仙、神、魔、妖，存在天庭、地府，可渡劫飞升，涉及蟠桃会、封神等事件，人物为仙人、妖怪、凡间修士等"
    fantasy_magic: "奇幻魔法世界：有精灵、矮人、兽人等种族，靠魔法水晶或元素之力施展魔法，王国与魔法学院并存，存在龙与宝藏，人物为魔法师、骑士、种族首领等"


# 爽点与节奏控制配置
rhythm_sensation_control:
  enabled: true
  description: "现代网文节奏与爽点生成规则"
  rules: |
    1. 每章必须有一个小高潮（爽点），可以是逆转、打脸、获得新能力、突破境界、惊险逃脱、情感升温等。
    2. 节奏安排：
       - 开头：用冲突、反常事件或神秘场景快速抓住读者
       - 中段：冲突升级、情绪波动、人物关系变化
       - 结尾：制造悬念或情绪高点，让读者迫切想看下一章
    3. 每个爽点必须由人物的目标与情绪驱动，不是无意义的事件堆砌。
    4. 对爽点场景要加重描写（细节、氛围、心理活动、动作），让读者有强烈代入感。
    5. 结尾悬念方式：
       - 突发事件（敌人出现、意外发生）
       - 关键信息揭露一半
       - 人物做出重大决定但结果未知
       - 高能瞬间戛然而止
    6. 禁止使用“故事未完待续”“下一章揭晓”等直接提示。

# 阶段1: 长文本API模型 → 整篇剧情摘要和伏笔 (>150字)
stage1_summary:
  name: "剧情摘要和伏笔生成"
  description: "将长文本转换为整篇剧情摘要和伏笔内容"
  prompt_template: |
    请将以下长篇小说文本转换为详细的剧情摘要和伏笔分析，要求：
    
    {copyright_bypass_info}
    
    1. 生成完整的剧情摘要（>150字），包含主要情节、人物关系和发展脉络
    2. 识别并分析重要的伏笔元素，包括：
       - 潜在的剧情转折点
       - 人物命运的暗示
       - 关键道具或符号的象征意义
       - 未解的谜团或悬念
    
    3. 确保摘要和分析具有逻辑性和连贯性
    4. 保持原文的核心风格和主题，但世界观已转换为{selected_world}
    
    请以以下格式输出：
    
    【剧情摘要】
    [在此处生成详细的剧情摘要]
    
    【伏笔分析】
    [在此处分析重要的伏笔元素]
    
    原文内容：
    {input_text}

# 阶段2: 基于剧情摘要和伏笔构建章节大纲 (100字/章)
stage2_chapter_outline:
  name: "章节大纲构建"
  description: "基于剧情摘要和伏笔内容生成章节大纲"
  prompt_template: |
    基于以下剧情摘要和伏笔分析，请为整篇小说构建合理的章节大纲：
    
    {copyright_bypass_info}
    
    【剧情摘要】
    {summary}
    
    【伏笔分析】
    {foreshadowing}
    
    要求：
    1. 根据故事发展逻辑合理划分章节，每章有明确的冲突或目标
    2. 每章大纲控制在300字左右
    3. 在大纲中体现人物驱动（角色动机、情绪变化）和冲突驱动
    4. 运用伏笔元素，保证情节连贯性
    5. 章节结尾预留悬念或引人期待的情绪点，不直接说明“下一章”或“故事未完待续”
    6. 遵循 {rhythm_sensation_control} 中的节奏与爽点规则
    
    请以以下格式输出：
    
    【章节大纲】
    第1章：[章节标题]
    [章节内容大纲，约100字，结尾有悬念]
    
    第2章：[章节标题]
    [章节内容大纲，约100字，结尾有悬念]
    
    [继续生成更多章节...]

# 阶段3: 基于章节大纲生成1k字内容
stage3_chapter_expansion:
  name: "章节内容生成"
  description: "基于章节大纲生成约1000字的具体章节内容，考虑上下文连贯性"
  prompt_template: |
    请基于以下章节大纲，创作约1000字的具体章节内容：
    
    {copyright_bypass_info}
    
    {previous_context}
    
    【章节大纲】
    {chapter_outline}
    
    要求：
    1. 基于大纲的核心情节和人物设定进行创作，不要直接扩写大纲文本
    2. 通过人物的目标、情绪、互动推动情节，而非单纯事件描述
    3. 添加丰富细节描写（环境氛围、内心独白、动作描写、情绪张力）
    4. 适当运用倒叙、插叙、对比等叙事手法增强节奏
    5. 章节结尾制造悬念或期待感，可用突发事件、关键线索、人物心理波动等方式，但避免直白提示读者等待下一章
    6. 控制字数在900-1100字之间
    7. 遵循 {rhythm_sensation_control} 中的节奏与爽点规则
    8. 【上下文连贯性要求】：
       - 参考前两章的内容，确保人物状态、情节发展、时间线的连贯性
       - 保持人物性格和行为的连续性，避免与前文矛盾
       - 如果前文有未解的伏笔或悬念，可以在本章中适当呼应或延续
       - 确保新发生的事件与前文逻辑一致，避免出现时间线错乱或人物突变
    
    请以小说的形式输出这一章的完整内容，不要重复大纲中的描述性文字。

# 阶段4: 1k → 2k扩写（深度优化和润色）
stage4_final_expansion:
  name: "最终扩写到2k字"
  description: "将章节内容从1k字扩写到约2000字并进行深度优化，考虑上下文连贯性"
  prompt_template: |
    请将以下章节内容从约1000字扩写到约2000字，并进行深度优化：
    
    {copyright_bypass_info}
    
    {previous_context}
    
    【章节内容】
    {chapter_content}
    
    要求：
    1. 保持原有情节主线和人物性格，不要重复或扩写章节大纲
    2. 更深入地刻画人物内心变化和冲突，强化人物驱动
    3. 丰富环境与氛围描写，适度加入对比和象征
    4. 增加对话细节和互动，避免生硬说明
    5. 章节结尾保留有力悬念或情绪高点，避免机械化收尾
    6. 控制字数在1800-2200字之间
    7. 遵循 {rhythm_sensation_control} 中的节奏与爽点规则
    8. 【上下文连贯性要求】：
       - 参考前两章的内容，确保人物状态、情节发展、时间线的连贯性
       - 保持人物性格和行为的连续性，避免与前文矛盾
       - 如果前文有未解的伏笔或悬念，可以在本章中适当呼应或延续
       - 确保新发生的事件与前文逻辑一致，避免出现时间线错乱或人物突变
       - 在深度优化过程中，注意与前后章节的衔接和呼应
    
    请以完整的小说章节形式输出扩写后的内容，不要重复大纲中的描述性文字。

# 输出格式配置
output_format:
  name: "标准化输出格式"
  description: "定义标准化的输出格式"
  format: |
    【{stage_name}】
    {timestamp}
    
    {content}
    
    ------------------------
